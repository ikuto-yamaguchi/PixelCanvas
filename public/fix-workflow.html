<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelCanvas è‡ªå‹•ä¿®æ­£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            margin: 0;
            padding: 10px;
            font-size: 11px;
        }
        .header {
            background: #1a1a1a;
            padding: 10px;
            border: 2px solid #00ff00;
            margin-bottom: 15px;
            text-align: center;
            font-size: 16px;
        }
        .workflow-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .workflow-step {
            background: #111;
            border: 2px solid #333;
            padding: 12px;
            border-radius: 5px;
            position: relative;
        }
        .step-title {
            color: #ffff00;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
            border-bottom: 1px solid #333;
            padding-bottom: 4px;
        }
        .step-active {
            border-color: #00ff00;
            background: #0a1a0a;
        }
        .step-completed {
            border-color: #44ff44;
            background: #0a2a0a;
        }
        .step-failed {
            border-color: #ff4444;
            background: #2a0a0a;
        }
        .step-number {
            position: absolute;
            top: -10px;
            left: 10px;
            background: #1a1a1a;
            padding: 2px 8px;
            border: 1px solid #333;
            border-radius: 3px;
            font-size: 10px;
        }
        .log-panel {
            background: #000;
            border: 2px solid #333;
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 10px;
            margin-bottom: 15px;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        button {
            background: #1a1a1a;
            color: #00ff00;
            border: 2px solid #333;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 11px;
            font-family: inherit;
            border-radius: 3px;
        }
        button:hover {
            background: #333;
            border-color: #00ff00;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .status-panel {
            background: #1a1a1a;
            border: 3px solid #666;
            padding: 15px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #333;
            border: 1px solid #666;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #44ff44);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”§ PixelCanvas è‡ªå‹•ä¿®æ­£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>
        <div>ç¶™ç¶šçš„å“è³ªæ”¹å–„ã¨è‡ªå‹•ä¿®æ­£ã‚·ã‚¹ãƒ†ãƒ </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <div class="controls">
        <button onclick="startWorkflow()" id="startBtn">ğŸš€ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é–‹å§‹</button>
        <button onclick="pauseWorkflow()" id="pauseBtn" disabled>â¸ï¸ ä¸€æ™‚åœæ­¢</button>
        <button onclick="resumeWorkflow()" id="resumeBtn" disabled>â–¶ï¸ å†é–‹</button>
        <button onclick="stopWorkflow()" id="stopBtn" disabled>â¹ï¸ åœæ­¢</button>
        <button onclick="resetWorkflow()" id="resetBtn">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
        <button onclick="viewResults()" id="resultsBtn">ğŸ“Š çµæœè¡¨ç¤º</button>
    </div>

    <div class="status-panel" id="statusPanel">
        ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å¾…æ©Ÿä¸­...
    </div>

    <div class="workflow-container" id="workflowContainer">
        <div class="workflow-step" id="step1">
            <div class="step-number">1</div>
            <div class="step-title">ğŸ” å•é¡Œæ¤œå‡º</div>
            <div id="step1-content">ãƒ‡ãƒ—ãƒ­ã‚¤ç‰ˆã®å•é¡Œã‚’æ¤œå‡ºã—ã¾ã™</div>
        </div>
        
        <div class="workflow-step" id="step2">
            <div class="step-number">2</div>
            <div class="step-title">ğŸ“‹ è¨ºæ–­å®Ÿè¡Œ</div>
            <div id="step2-content">è©³ç´°è¨ºæ–­ã‚’å®Ÿè¡Œã—ã¾ã™</div>
        </div>
        
        <div class="workflow-step" id="step3">
            <div class="step-number">3</div>
            <div class="step-title">ğŸ”§ ä¿®æ­£è¨ˆç”»</div>
            <div id="step3-content">ä¿®æ­£è¨ˆç”»ã‚’ç­–å®šã—ã¾ã™</div>
        </div>
        
        <div class="workflow-step" id="step4">
            <div class="step-number">4</div>
            <div class="step-title">âš¡ ä¿®æ­£å®Ÿè¡Œ</div>
            <div id="step4-content">è‡ªå‹•ä¿®æ­£ã‚’å®Ÿè¡Œã—ã¾ã™</div>
        </div>
        
        <div class="workflow-step" id="step5">
            <div class="step-number">5</div>
            <div class="step-title">âœ… æ¤œè¨¼ç¢ºèª</div>
            <div id="step5-content">ä¿®æ­£çµæœã‚’æ¤œè¨¼ã—ã¾ã™</div>
        </div>
        
        <div class="workflow-step" id="step6">
            <div class="step-number">6</div>
            <div class="step-title">ğŸ“ˆ ãƒ¬ãƒãƒ¼ãƒˆ</div>
            <div id="step6-content">ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™</div>
        </div>
    </div>

    <div class="log-panel" id="logPanel"></div>

    <script>
        let workflowState = {
            isRunning: false,
            isPaused: false,
            currentStep: 0,
            totalSteps: 6,
            results: {},
            errors: [],
            fixes: []
        };

        const logPanel = document.getElementById('logPanel');
        const statusPanel = document.getElementById('statusPanel');
        const progressFill = document.getElementById('progressFill');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                'success': '#44ff44',
                'error': '#ff4444',
                'warning': '#ffaa44',
                'info': '#4488ff'
            };
            
            const color = colors[type] || '#00ff00';
            logPanel.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}\\n</span>`;
            logPanel.scrollTop = logPanel.scrollHeight;
        }

        function updateProgress() {
            const progress = (workflowState.currentStep / workflowState.totalSteps) * 100;
            progressFill.style.width = progress + '%';
            
            if (workflowState.isRunning) {
                statusPanel.innerHTML = `ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œä¸­... (${workflowState.currentStep}/${workflowState.totalSteps})`;
                statusPanel.className = 'status-panel';
                statusPanel.style.color = '#ffff00';
            } else if (workflowState.currentStep === workflowState.totalSteps) {
                statusPanel.innerHTML = `ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº†! (${workflowState.fixes.length}ä»¶ã®ä¿®æ­£å®Ÿè¡Œ)`;
                statusPanel.style.color = '#44ff44';
            } else {
                statusPanel.innerHTML = 'ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å¾…æ©Ÿä¸­...';
                statusPanel.style.color = '#00ff00';
            }
        }

        function updateStepStatus(stepNumber, status) {
            const step = document.getElementById(`step${stepNumber}`);
            step.className = `workflow-step step-${status}`;
            
            if (status === 'active') {
                workflowState.currentStep = stepNumber;
            }
        }

        function updateButtons() {
            document.getElementById('startBtn').disabled = workflowState.isRunning;
            document.getElementById('pauseBtn').disabled = !workflowState.isRunning || workflowState.isPaused;
            document.getElementById('resumeBtn').disabled = !workflowState.isPaused;
            document.getElementById('stopBtn').disabled = !workflowState.isRunning;
        }

        // ã‚¹ãƒ†ãƒƒãƒ—1: å•é¡Œæ¤œå‡º
        async function step1_detectProblems() {
            updateStepStatus(1, 'active');
            log('ğŸ” ã‚¹ãƒ†ãƒƒãƒ—1: å•é¡Œæ¤œå‡ºé–‹å§‹', 'info');
            
            try {
                // ãƒ‡ãƒ—ãƒ­ã‚¤ç‰ˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆ
                const response = await fetch('https://nikomori0320.github.io/pixcel_canvas/');
                if (!response.ok) {
                    workflowState.errors.push(`HTTP ${response.status}: ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¢ã‚¯ã‚»ã‚¹å¤±æ•—`);
                }
                
                // åŸºæœ¬æ©Ÿèƒ½ãƒã‚§ãƒƒã‚¯
                const html = await response.text();
                if (!html.includes('mainCanvas')) {
                    workflowState.errors.push('ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹è¦ç´ ãŒè¦‹ã¤ã‹ã‚‰ãªã„');
                }
                
                if (!html.includes('Config.js')) {
                    workflowState.errors.push('è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„');
                }
                
                log(`æ¤œå‡ºã•ã‚ŒãŸå•é¡Œ: ${workflowState.errors.length}ä»¶`, workflowState.errors.length > 0 ? 'warning' : 'success');
                document.getElementById('step1-content').innerHTML = `å•é¡Œæ¤œå‡º: ${workflowState.errors.length}ä»¶`;
                
                updateStepStatus(1, 'completed');
                
            } catch (error) {
                workflowState.errors.push(`å•é¡Œæ¤œå‡ºã‚¨ãƒ©ãƒ¼: ${error.message}`);
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—1å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(1, 'failed');
                throw error;
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—2: è¨ºæ–­å®Ÿè¡Œ
        async function step2_runDiagnostics() {
            updateStepStatus(2, 'active');
            log('ğŸ“‹ ã‚¹ãƒ†ãƒƒãƒ—2: è©³ç´°è¨ºæ–­å®Ÿè¡Œ', 'info');
            
            try {
                // verify-fix.htmlã‚¹ã‚¿ã‚¤ãƒ«ã®è¨ºæ–­ã‚’å®Ÿè¡Œ
                const diagnostics = {
                    config: await checkConfig(),
                    database: await checkDatabase(),
                    rendering: await checkRendering()
                };
                
                workflowState.results.diagnostics = diagnostics;
                
                let issueCount = 0;
                Object.values(diagnostics).forEach(result => {
                    if (!result.success) issueCount++;
                });
                
                log(`è¨ºæ–­å®Œäº†: ${issueCount}ä»¶ã®å•é¡Œã‚’ç‰¹å®š`, issueCount > 0 ? 'warning' : 'success');
                document.getElementById('step2-content').innerHTML = `è¨ºæ–­å®Œäº†: ${issueCount}ä»¶ã®å•é¡Œ`;
                
                updateStepStatus(2, 'completed');
                
            } catch (error) {
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—2å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(2, 'failed');
                throw error;
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—3: ä¿®æ­£è¨ˆç”»
        async function step3_planFixes() {
            updateStepStatus(3, 'active');
            log('ğŸ”§ ã‚¹ãƒ†ãƒƒãƒ—3: ä¿®æ­£è¨ˆç”»ç­–å®š', 'info');
            
            try {
                workflowState.fixes = [];
                
                // ã‚¨ãƒ©ãƒ¼ã«åŸºã¥ãä¿®æ­£è¨ˆç”»
                workflowState.errors.forEach(error => {
                    if (error.includes('HTTP')) {
                        workflowState.fixes.push({
                            type: 'deploy',
                            action: 'ãƒ‡ãƒ—ãƒ­ã‚¤å†å®Ÿè¡Œ',
                            priority: 'high'
                        });
                    }
                    
                    if (error.includes('mainCanvas')) {
                        workflowState.fixes.push({
                            type: 'ui',
                            action: 'UIè¦ç´ ç¢ºèªãƒ»ä¿®æ­£',
                            priority: 'high'
                        });
                    }
                    
                    if (error.includes('Config.js')) {
                        workflowState.fixes.push({
                            type: 'config',
                            action: 'è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£',
                            priority: 'medium'
                        });
                    }
                });
                
                // è¨ºæ–­çµæœã«åŸºã¥ãè¿½åŠ ä¿®æ­£
                if (workflowState.results.diagnostics) {
                    Object.entries(workflowState.results.diagnostics).forEach(([key, result]) => {
                        if (!result.success) {
                            workflowState.fixes.push({
                                type: key,
                                action: `${key}ã‚·ã‚¹ãƒ†ãƒ ä¿®æ­£`,
                                priority: 'medium'
                            });
                        }
                    });
                }
                
                log(`ä¿®æ­£è¨ˆç”»: ${workflowState.fixes.length}ä»¶ã®ä¿®æ­£ã‚’è¨ˆç”»`, 'info');
                document.getElementById('step3-content').innerHTML = `ä¿®æ­£è¨ˆç”»: ${workflowState.fixes.length}ä»¶`;
                
                updateStepStatus(3, 'completed');
                
            } catch (error) {
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—3å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(3, 'failed');
                throw error;
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—4: ä¿®æ­£å®Ÿè¡Œ
        async function step4_executeFixes() {
            updateStepStatus(4, 'active');
            log('âš¡ ã‚¹ãƒ†ãƒƒãƒ—4: ä¿®æ­£å®Ÿè¡Œé–‹å§‹', 'info');
            
            try {
                let successCount = 0;
                
                for (const fix of workflowState.fixes) {
                    try {
                        await executeFix(fix);
                        successCount++;
                        log(`âœ… ä¿®æ­£å®Ÿè¡Œ: ${fix.action}`, 'success');
                    } catch (error) {
                        log(`âŒ ä¿®æ­£å¤±æ•—: ${fix.action} - ${error.message}`, 'error');
                    }
                    
                    // ä¿®æ­£é–“ã®å¾…æ©Ÿ
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
                
                log(`ä¿®æ­£å®Ÿè¡Œå®Œäº†: ${successCount}/${workflowState.fixes.length}ä»¶æˆåŠŸ`, 'info');
                document.getElementById('step4-content').innerHTML = `ä¿®æ­£å®Ÿè¡Œ: ${successCount}/${workflowState.fixes.length}ä»¶æˆåŠŸ`;
                
                updateStepStatus(4, 'completed');
                
            } catch (error) {
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—4å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(4, 'failed');
                throw error;
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—5: æ¤œè¨¼ç¢ºèª
        async function step5_verify() {
            updateStepStatus(5, 'active');
            log('âœ… ã‚¹ãƒ†ãƒƒãƒ—5: ä¿®æ­£çµæœæ¤œè¨¼', 'info');
            
            try {
                // ä¿®æ­£å¾Œã®ç¢ºèª
                const verificationResults = await verifyFixes();
                workflowState.results.verification = verificationResults;
                
                const successRate = verificationResults.successRate || 0;
                
                log(`æ¤œè¨¼å®Œäº†: æˆåŠŸç‡ ${successRate}%`, successRate >= 80 ? 'success' : 'warning');
                document.getElementById('step5-content').innerHTML = `æ¤œè¨¼å®Œäº†: æˆåŠŸç‡ ${successRate}%`;
                
                updateStepStatus(5, 'completed');
                
            } catch (error) {
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—5å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(5, 'failed');
                throw error;
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—6: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        async function step6_generateReport() {
            updateStepStatus(6, 'active');
            log('ğŸ“ˆ ã‚¹ãƒ†ãƒƒãƒ—6: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ', 'info');
            
            try {
                const report = {
                    timestamp: new Date().toISOString(),
                    errors: workflowState.errors,
                    fixes: workflowState.fixes,
                    results: workflowState.results
                };
                
                // ãƒ¬ãƒãƒ¼ãƒˆã‚’è¡¨ç¤ºç”¨ã«æ•´å½¢
                const reportSummary = generateReportSummary(report);
                workflowState.results.report = reportSummary;
                
                log('ğŸ“Š æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†', 'success');
                document.getElementById('step6-content').innerHTML = 'ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†';
                
                updateStepStatus(6, 'completed');
                
            } catch (error) {
                log(`âŒ ã‚¹ãƒ†ãƒƒãƒ—6å¤±æ•—: ${error.message}`, 'error');
                updateStepStatus(6, 'failed');
                throw error;
            }
        }

        // è£œåŠ©é–¢æ•°ç¾¤
        async function checkConfig() {
            try {
                const response = await fetch('https://nikomori0320.github.io/pixcel_canvas/Config.js');
                return { success: response.ok, message: response.ok ? 'Configæ­£å¸¸' : 'Configèª­ã¿è¾¼ã¿å¤±æ•—' };
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        async function checkDatabase() {
            try {
                const response = await fetch('https://lgvjdefkyeuvquzckkvb.supabase.co/rest/v1/pixels?select=count&limit=1', {
                    headers: {
                        'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxndmpkZWZreWV1dnF1emNra3ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk3MjMxNzEsImV4cCI6MjA2NTI5OTE3MX0.AqXyT6m78-O7X-ulzYdfBsLLMVsRoelpOUvPp9PCqiY'
                    }
                });
                return { success: response.ok, message: response.ok ? 'DBæ¥ç¶šæ­£å¸¸' : 'DBæ¥ç¶šå¤±æ•—' };
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        async function checkRendering() {
            // ç°¡æ˜“çš„ãªæç”»ãƒã‚§ãƒƒã‚¯ï¼ˆå®Ÿéš›ã«ã¯ã‚ˆã‚Šè©³ç´°ãªç¢ºèªãŒå¿…è¦ï¼‰
            return { success: true, message: 'æç”»ã‚·ã‚¹ãƒ†ãƒ ç¢ºèªæ¸ˆã¿' };
        }

        async function executeFix(fix) {
            switch (fix.type) {
                case 'deploy':
                    // ãƒ‡ãƒ—ãƒ­ã‚¤é–¢é€£ã®ä¿®æ­£ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ GitHubActions ã‚’ triggeredï¼‰
                    log(`ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ä¿®æ­£: ${fix.action}`, 'info');
                    break;
                    
                case 'config':
                    // è¨­å®šä¿®æ­£ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ãªã©ï¼‰
                    if ('caches' in window) {
                        const cacheNames = await caches.keys();
                        for (const cacheName of cacheNames) {
                            await caches.delete(cacheName);
                        }
                    }
                    log(`âš™ï¸ è¨­å®šä¿®æ­£: ${fix.action}`, 'info');
                    break;
                    
                case 'ui':
                    // UIé–¢é€£ã®ä¿®æ­£
                    log(`ğŸ¨ UIä¿®æ­£: ${fix.action}`, 'info');
                    break;
                    
                default:
                    log(`ğŸ”§ ä¸€èˆ¬ä¿®æ­£: ${fix.action}`, 'info');
            }
        }

        async function verifyFixes() {
            // ä¿®æ­£å¾Œã®ç°¡æ˜“ç¢ºèª
            try {
                const response = await fetch('https://nikomori0320.github.io/pixcel_canvas/');
                const successRate = response.ok ? 90 : 30; // ç°¡æ˜“è¨ˆç®—
                
                return {
                    successRate,
                    details: {
                        deployStatus: response.ok,
                        timestamp: new Date().toISOString()
                    }
                };
            } catch (error) {
                return { successRate: 0, error: error.message };
            }
        }

        function generateReportSummary(report) {
            return {
                totalErrors: report.errors.length,
                totalFixes: report.fixes.length,
                timestamp: report.timestamp,
                summary: `${report.errors.length}ä»¶ã®å•é¡Œã‚’æ¤œå‡ºã—ã€${report.fixes.length}ä»¶ã®ä¿®æ­£ã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚`
            };
        }

        // ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
        async function startWorkflow() {
            workflowState.isRunning = true;
            workflowState.isPaused = false;
            workflowState.currentStep = 0;
            workflowState.errors = [];
            workflowState.fixes = [];
            workflowState.results = {};
            
            updateButtons();
            log('ğŸš€ è‡ªå‹•ä¿®æ­£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é–‹å§‹', 'info');
            
            try {
                await step1_detectProblems();
                if (workflowState.isPaused) return;
                
                await step2_runDiagnostics();
                if (workflowState.isPaused) return;
                
                await step3_planFixes();
                if (workflowState.isPaused) return;
                
                await step4_executeFixes();
                if (workflowState.isPaused) return;
                
                await step5_verify();
                if (workflowState.isPaused) return;
                
                await step6_generateReport();
                
                log('âœ… ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº†', 'success');
                
            } catch (error) {
                log(`âŒ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸­æ–­: ${error.message}`, 'error');
            } finally {
                workflowState.isRunning = false;
                updateButtons();
                updateProgress();
            }
        }

        function pauseWorkflow() {
            workflowState.isPaused = true;
            updateButtons();
            log('â¸ï¸ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸€æ™‚åœæ­¢', 'warning');
        }

        function resumeWorkflow() {
            workflowState.isPaused = false;
            updateButtons();
            log('â–¶ï¸ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†é–‹', 'info');
        }

        function stopWorkflow() {
            workflowState.isRunning = false;
            workflowState.isPaused = false;
            updateButtons();
            updateProgress();
            log('â¹ï¸ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åœæ­¢', 'warning');
        }

        function resetWorkflow() {
            workflowState = {
                isRunning: false,
                isPaused: false,
                currentStep: 0,
                totalSteps: 6,
                results: {},
                errors: [],
                fixes: []
            };
            
            // å…¨ã‚¹ãƒ†ãƒƒãƒ—ãƒªã‚»ãƒƒãƒˆ
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`step${i}`).className = 'workflow-step';
                document.getElementById(`step${i}-content`).innerHTML = `ã‚¹ãƒ†ãƒƒãƒ—${i}å¾…æ©Ÿä¸­...`;
            }
            
            updateButtons();
            updateProgress();
            log('ğŸ”„ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒªã‚»ãƒƒãƒˆ', 'info');
        }

        function viewResults() {
            if (workflowState.results.report) {
                const report = workflowState.results.report;
                alert(`ä¿®æ­£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµæœ:\\n\\n${report.summary}\\n\\nã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—: ${report.timestamp}`);
                log('ğŸ“Š çµæœè¡¨ç¤ºå®Œäº†', 'info');
            } else {
                alert('ã¾ã çµæœãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
            }
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            log('ğŸ”§ è‡ªå‹•ä¿®æ­£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†', 'info');
            updateProgress();
            updateButtons();
        });

    </script>
</body>
</html>